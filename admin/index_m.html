<html>

<head>

    <!-- Load ioBroker scripts and styles-->
    <link rel="stylesheet" type="text/css" href="../../css/adapter.css" />
    <link rel="stylesheet" type="text/css" href="../../lib/css/materialize.css">
    <link rel="stylesheet" type="text/css" href="../../lib/css/fancytree/ui.fancytree.min.css" />
    <link type="text/css" rel="stylesheet" href="../../lib/css/themes/jquery-ui/default/jquery-ui.min.css">
    <link rel="stylesheet" type="text/css" href="../../lib/css/iob/selectID.css" />

    <script type="text/javascript" src="../../lib/js/jquery-3.2.1.min.js"></script>
    <script type="text/javascript" src="../../lib/js/jquery-ui-1.10.3.full.min.js"></script>
    <script type="text/javascript" src="../../lib/js/jquery-ui.min.js"></script>
    <script type="text/javascript" src="../../lib/js/jquery.fancytree-all.min.js"></script>
    <script type="text/javascript" src="../../lib/js/materialize.js"></script>
    <script type="text/javascript" src="../../socket.io/socket.io.js"></script>
    <script type="text/javascript" src="../../lib/js/selectID.js"></script>
    <script type="text/javascript" src="../../js/translate.js"></script>
    <script type="text/javascript" src="../../js/adapter-settings.js"></script>
    <script type="text/javascript" src="words.js"></script>

    <!-- Load our own files -->
    <link rel="stylesheet" type="text/css" href="style.css" />
    <script type="text/javascript" src="./lib/loadUser.js"></script>
    <script type="text/javascript" src="./lib/dataSendTo.js"></script>
    <script type="text/javascript" src="./lib/createData.js"></script>
    <script type="text/javascript" src="./lib/createSettings.js"></script>
    <script type="text/javascript" src="./lib/createDynamicTable.js"></script>
    <script type="text/javascript" src="./lib/createArray.js"></script>

    <script type="text/javascript">

        let showSaveBtn;

        let headerOpened = ``;

        let device = [];

        let checkedUserInput = {};  // alle geprueften User Inputs werden hier gespeichert
        let dataGlobal = {};        // alle native Daten aus "settings" werden hier gespeichert

        // This will be called by the admin adapter when the settings page loads
        async function load(settings, onChange) {

            $('.btn-save, .btn-save-close').css("display", "none");
            if (settings.devices === undefined || settings.devices.length <= 0) {
                $('.dynamic-table-devices').css("display", "none");
            };

            if (!settings) return;
            let namespace = `${adapter}.${instance}`;
            // instance alive?
            socket.emit('getState', `system.adapter.${namespace}.alive`, async (err, state) => {
                try {
                    const active = (state && state.val);
                    if (!active) {
                        $(`#test`).html(`<div class="collapsible-header red lighten-1"><i class="large material-icons">error_outline</i>Please activate the device-reminder.${instance} instance!</div>`);
                    } else {
                        showSaveBtn = onChange;
                        let actSettings = {};

                        actSettings = await settings;

                        createGUI(actSettings);

                        $('.collapsible').collapsible();
                        $('.modal').modal();

                        async function createGUI(settings) {

                            dataGlobal = await createData(settings);
                            const resChecked = await staticTable(dataGlobal);
                            await dynamicTable(dataGlobal, resChecked);
                            $('.red').on('click', clickEventDelBtn); // click event auf delete button setzen
                            onChange(false);

                            // create table
                            async function staticTable(data) {
                                for (const i in data) {
                                    const name = data[i].name;
                                    if (name !== 'telegram' && name !== 'whatsapp') {
                                        if (name !== 'devices') {
                                            values2table(data[i].idHTML, data[i].ids, onChange); // create table
                                        };

                                        // create click event "disable save button"
                                        const btnSave = `#btn-check-${name}`;
                                        $(btnSave).fadeOut(); // save buttons deaktivieren bis events auf "add button" erkannt
                                        $(btnSave).on('click', async () => {
                                            dataGlobal = await btnPressed(settings, i);
                                            $(btnSave).fadeOut();
                                            if (btnSave === `#btn-check-types`) {
                                                const resDeviceID = await table2values(data.devices.idHTML); // Daten aus table "deviceID" holen
                                                values2table(data.devices.idHTML, resDeviceID, onChange); // table "deviceID" neu erstellen
                                            };
                                        });

                                        // create click event "add button"
                                        const btnAdd = `#btn-add-${name}`;
                                        $(btnAdd).on('click', async () => {
                                            $(btnSave).fadeIn();
                                            $(`#err-${name}`).html(`<div style="display: flex; align-items: center; color: red;">
                                                <span style="font-weight:bold;">${_("Pls check input")}</span></div>`);
                                            $('.btn-save, .btn-save-close').fadeOut();
                                            if (btnAdd === '#btn-add-devices') {
                                                setTimeout(() => {
                                                    refreshTblDeviceID()
                                                    console.warn('devices')
                                                }, 500);
                                            };
                                            onChange(false);
                                        });

                                        // create event "change" on table
                                        const eventID = `#${data[i].idHTML}`;
                                        if (eventID !== `#${data.status.idHTML}`) {
                                            $(eventID).on('change keyup', () => {
                                                $(`#btn-check-${name}`).fadeIn();
                                                $(`#err-${name}`).html(`<div style="display: flex; align-items: center; color: red;">
                                                    <span style="font-weight:bold;">${_("Pls check input")}</span></div>`);
                                                $('.btn-save, .btn-save-close').fadeOut();
                                                onChange(false);
                                            });
                                        } else {
                                            $(`#${data.status.idHTML}`).find('.values-input').on('change', () => {
                                                $('.btn-save, .btn-save-close').fadeIn();
                                                onChange(true);
                                            });
                                        };
                                    };
                                };

                                const checked = await checkInput(data, 'all');
                                checkedUserInput = checked;

                                values2table(data.devices.idHTML, data.devices.ids, onChange); // create table "devices", warten auf "types"

                                if(!data.costs.ids[0].active) {
                                    showCell('none'); // Auswahlfelder fuer Kosten ausblenden
                                };  

                                // Click-Event auf "Kosten aktiv" setzen -> Dann werden zusaetzliche Optionen im Table "devicesID" angezeigt
                                $(`#${data.costs.idHTML}`).find('.filled-in').on('change', () => {
                                    $('#create_Devices').html("");
                                    let test = ''
                                    test = ` <thead>
                                                <tr>
                                                    <th data-name="_index" style="width: 40px" class="header translate"></th>
                                                    <th data-name="name" style="width: 150px" data-type="text" class="header translate" data-lang="device name"></th>
                                                    <th id="deviceTypeID" data-name="type" style="width: 200px;" data-type="select" style="width: 150px"class="header translate" data-options="" data-lang="device type"></th>
                                                    <th data-name="consumption" style="width: 100px" data-type="OID" class="header translate" data-lang="consumption"></th>
                                                    <th data-name="switch" style="width: 100px" data-type="OID" class="header translate" data-lang="Power switch"></th>
                                                    <th data-name="startText" data-type="OID" class="header translate" data-lang="starttext"></th>
                                                    <th data-name="endText" data-type="OID" class="header translate" data-lang="endtext"></th>
                                                    <th data-name="consumptionTotal" style="width: 100px" data-type="OID" class="header translate" data-lang="total consumption" id="showConsTotal"></th>
                                                    <th data-name="unit" style="width: 100px" data-type="select" data-options="kWh;wh" data-default="kWh" class="header translate" id="showUnit" data-lang="unit"></th>
                                                    <th data-buttons="delete" style="width: 80px;" class="header translate del-Btn" data-lang="delete"></th>
                                                    <th data-name="id" style="width: 0px; display: none;" class="header translate">id</th>
                                                </tr>
                                            </thead>`

                                    // $('#create_Devices').html(test);

                                    refreshTblDeviceID();
                                });

                                async function refreshTblDeviceID() {
                                    const resCosts = await table2values(data.costs.idHTML); // Daten aus table "Kosten" holen
                                    const resDeviceID = await table2values(data.devices.idHTML); // Daten aus table "deviceID" holen
                                    if (!resCosts[0].active) {
                                        showCell('none'); // Auswahlfelder fuer Kosten ausblenden
                                    } else {
                                        showCell('table-cell'); // Auswahlfelder fuer Kosten einblenden
                                        values2table(data.devices.idHTML, resDeviceID, onChange); // table "deviceID" neu erstellen
                                    };
                                    if (M) M.updateTextFields();
                                };

                                /**
                                 * @param {string} action
                                 */
                                function showCell(action) {
                                    $('#create_Devices [data-name="consumptionTotal"]').css('display', action);
                                    $('#create_Devices [data-name="unit"]').css('display', action);
                                    if(action === 'none') {
                                        $('#create_Devices tr td').eq(7).css('display', action);
                                        $('#create_Devices tr td').eq(8).css('display', action);
                                    };
                                };

                                return checked;
                            };

                            async function dynamicTable(data, checked) {
                                dataGlobal = await createDynamicTable(data, onChange, checked); // create dynamic table "device"
                                if (M) M.updateTextFields();
                                // onChange(false);
                            };

                            async function btnPressed(settings, name) {
                                console.warn(name)
                                const actData = await createData(settings)
                                const data = await createSettings(actData);
                                // dataGlobal = await createSettings(actData);
                                const result = await checkInput(actData, name);
                                checkedUserInput[actData[name].name] = result[name];
                                dynamicTable(actData, checkedUserInput);

                                $('.red').on('click', clickEventDelBtn); // click event auf delete button setzen

                                if (checkedUserInput.devices !== undefined && checkedUserInput.devices.length >= 1) {
                                    $('.dynamic-table-devices').fadeIn();
                                    $('.btn-save, .btn-save-close').fadeIn();
                                };
                                
                                onChange(true);

                                return data;
                            };

                            // create click event "delete device (delete button)"
                            async function clickEventDelBtn() {
                                if (headerOpened !== ``) { // Abfrage welcher button geklickt wurde
                                    clearTimeout;
                                    setTimeout(async () => {
                                        dataGlobal = await btnPressed(settings, headerOpened)
                                        onChange(true);
                                        if (dataGlobal.devices !== undefined && dataGlobal.devices.ids.length >= 1) {
                                            $('.dynamic-table-devices').fadeIn();
                                            $('.btn-save, .btn-save-close').fadeIn();
                                        } else {
                                            $('.dynamic-table-devices').fadeOut();
                                        };
                                    }, 100);
                                };
                            };

                        };
                        // ----
                    };
                } catch (e) {
                    console.error(e)
                };
            });
        };

        //##################################################################################################
        //############################################ Load End ############################################
        //##################################################################################################

        //##################################################################################################
        //############################################ save start ##########################################
        //##################################################################################################

        async function save(callback) {

            const actData = await createSettings(dataGlobal, 'save'); // aktuelle settings holen

            const cntr = await saveCntr(actData);   // counter fuer save obj erstellen

            const result = await loopArr(cntr) // devices, messenger, etc "final" erstellen

            let resultTemp = result

            const finalObj = resultTemp; // fertiges objekt fuer native settings

            async function saveCntr(actData) {
                // counter in die native schreiben
                let objTemp = actData;
                for (const name in actData) {
                    const cntrName = `${name}_counter`
                    objTemp[cntrName] = actData[name].cntr;
                };
                return objTemp;
            };

            async function loopArr(objCntr) {
                let objTemp = objCntr;
                for (const i in dataGlobal) {
                    const id = dataGlobal[i].name;
                    objTemp[id] = {
                        id: dataGlobal[i].ids,
                        final: await createArray(dataGlobal[i]),
                    };
                };
                return objTemp;
            };
            callback(finalObj); // daten in native settings schreiben
        };

        async function checkInput(data, type) {

            const result = await loop(type);
            return result;

            // user input überprüfen und auf callback warten
            function deviceCheck(dataSendTo, data, successCallback, errorCallback) {

                const name = dataSendTo.name
                // const id = dataSendTo.id
                const objType = dataSendTo.objType
                let obj = dataSendTo.obj;
                let arr;

                if (name != 'telegram' && name != 'whatsapp') {   // telegram / whatsapp uebergibt nur einen counter
                    arr = data.ids;
                } else {
                    arr = data;
                };

                try {
                    sendTo(null, objType, arr, async result => {
                        const res = await result;
                        if (res != undefined) {
                            obj.dataChecked = res.checked || [];
                            obj.dataFailed = res.failed || [];
                            if (name === 'types') { // device types erstellen
                                let objTemp = {};
                                const deviceTypes = await createArrTypes(name, res.checked);
                                $('#deviceTypeID').attr("data-options", deviceTypes.join(';'));
                                
                                /**
                                * @param {string} name;
                                * @param {{}} res;
                                */
                                async function createArrTypes(name, res) {
                                    let arrTemp = [];
                                    for (const i in res) {
                                        arrTemp.push(res[i].name)
                                    };
                                    return arrTemp;
                                };
                            };
                            if (name !== 'telegram' && name !== 'whatsapp') { // telegram / whatsapp hat kein Auswahlfeld 
                                checked(obj);   // Auswahlfelder erstellen
                            };
                            showHeader('dynamicTable', name, res.checked); // erkannte Geraete in "dynamicTable" einblenden
                            successCallback(res.checked);
                        };
                    });
                } catch (error) {
                    errorCallback(error);
                };
            };

            // promise erstellen
            function functionWrapper(dataSendTo, data) {
                return new Promise((resolve, reject) => {
                    deviceCheck(dataSendTo, data, (successResponse) => {
                        resolve(successResponse);
                    }, (errorResponse) => {
                        reject(errorResponse);
                    });
                });
            };

            async function functionLogic(dataSendTo, data) {
                try {
                    const result = await functionWrapper(dataSendTo, data);
                    return result;
                } catch (error) {
                    console.error("ERROR:" + error);
                };
            };

            async function loop(type) {

                try {
                    let result = {};
                    let checkData = {};
                    if (type !== 'all') {
                        checkData[type] = dataSendTo[type];
                    } else {
                        checkData = dataSendTo;
                    };

                    for (const i in checkData) { // check aller inputs 
                        const name = checkData[i].name
                        let obj = checkData[i].obj;
                        let arr = data[i].ids;
                        if (name == 'status' || name =='costs') { // status wird nicht geprüft, da jede Eingabe erlaubt ist 
                            checked(checkData[name].obj)
                            $(`#err-${name}`).css('display', 'none');
                        } else {
                            result[name] = [];
                            if (name == 'telegram' || name == 'whatsapp') {
                                result[name] = await functionLogic(checkData[i], 0); // daten in der main.js prüfen und return
                            } else {
                                result[name] = await functionLogic(checkData[i], data[i]); // daten in der main.js prüfen und return
                            }
                        };
                    };
                    return result
                } catch (error) {
                    console.error(error);
                };
            };

            async function checked(obj) {
                if (obj.name !== `'device status'` && obj.name !== `'costs'` && (obj.dataChecked.length <= 0) && (obj.dataFailed.length <= 0)) {
                    $(`#${obj.err}`).html(`<div style="display: flex; align-items: center; color: grey;">
                            <i class="material-icons">check_circle_outline</i><span>${_("no entries found")}</span> </div>`);
                    // Header innen "config devices"
                    $(`#${obj.header}`).html(`<div class="collapsible-header grey lighten-2 translate"><i class="material-icons">create</i><span>${_("Create %s", obj.name)}</span></div>`);
                    showSaveBtn(true); // save button einblenden
                } else if (obj.dataFailed.length >= 1) {
                    $(`#${obj.err}`).html(`<div style="display: flex; align-items: center; color: red;">
                            <i class="large material-icons">error_outline</i><span><b>${_("invalid input detected")}:</b><br> - ${obj.dataFailed.join('<br> - ')}</span></div>`);
                    // Header innen "config devices"
                    const text = `${obj.dataFailed.length} error(s) found in `
                    $(`#${obj.header}`).html(`<div class="collapsible-header red lighten-2 translate"><i class="material-icons">create</i><span>${_("Error(s) found in %s", obj.name)}</span></div>`);
                    // Header außen "config devices"
                    $(`#header-config`).html(`<div class="collapsible-header red lighten-2 translate"><i class="material-icons">create</i><span>${_("Error(s) found in configuration")}</span></div>`);
                    $('.btn-save, .btn-save-close').fadeOut();
                } else {
                    $(`#${obj.err}`).html(`<div style="display: flex; align-items: center; color: green;">
                            <i class="material-icons">check_circle_outline</i><span class="translate" style="font-weight:bold;">${_("Input checked")}</span></div>`);
                    // Header innen "config devices"
                    $(`#${obj.header}`).html(`<div class="collapsible-header green lighten-2"><i class="material-icons">create</i><span>${_("Edit %s", obj.name)}</span></div>`);
                };
                $(`#help-${obj.anchorName}`).html(`<div><h4>create ${obj.name}</h4><p><a href="https://github.com/Xenon-s/ioBroker.device-reminder/blob/master/README.md#${obj.anchorEn}" target="_blank">${obj.anchorEn} english</a></p>
                    <p><a href="https://github.com/Xenon-s/ioBroker.device-reminder/blob/master/README_GER.md#${obj.anchorGer}" target="_blank">${obj.anchorGer} deutsch</a></p></div>`);
            };
        };

        function showHeader(tblId, columnName, arr) {
            if (columnName !== undefined) {
                if (arr.length > 0 && columnName !== undefined) {
                    $('#' + tblId + ' [data-name="' + columnName + '"]').css('display', 'table-cell');
                }
                else {
                    $('#' + tblId + ' [data-name="' + columnName + '"]').css('display', 'none');
                };
            };
        };

        function selectedHeader(str) {
            if (headerOpened === ``) {
                headerOpened = str;
            } else {
                headerOpened = headerOpened === str ? `` : str;
            };
        };

    </script>
</head>

<body>
    <div class="m adapter-container">
        <div class="row" id="test">
            <!-- Tabs: Menu -->
            <div class="col s12 .tabs-fixed-width"
                style="padding-left:0;padding-right:0; margin-top: 0px; margin-bottom: 1px; background-color:#174475; box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12), 0 3px 1px -2px rgba(0, 0, 0, 0.2);">
                <ul class="tabs blue lighten-4">
                    <li class="tab col s3"><a href="#tab-config" class="translate">Config</a></li>
                    <!-- <li class="tab col s3 disabled"><a href="#tab-advanced-settings" class="translate">advanced settings</a></li> -->
                </ul>
            </div>

            <div class="row">
                <!-- Tab with id "config" -->
                <div id="tab-config" class="col s12">
                    <div class="row">
                        <div class="row">
                            <div class="input-field col s3">
                                <img src="icon.png">
                            </div>
                        </div>


                        <!-- Modal Structure -->
                        <div id="modal-warning" class="modal">
                            <div class="modal-content">

                            </div>
                            <div class="modal-footer">
                                <a href="#!" class="modal-close waves-effect waves-green btn-flat">understand</a>
                            </div>
                        </div>

                        <div class="dynamic-table-devices">
                            <div id="header-link-device">
                                <!-- text -->
                            </div>
                            <div class="blue lighten-5" id="device">

                                <div class="card-panel blue lighten-5">
                                    <table id="dynamicTable"
                                        class="table-values changeOnChangeEvent remove-last-column">
                                        <thead>
                                            <tr>
                                                <th class="header translate" data-name="enabled" style="width: 60px">active</th>
                                                <th class="header translate" data-name="name" style="width: 200px">device</th>
                                                <th class="header translate" data-name="alexa">alexa</th>
                                                <th class="header translate" data-name="sayit">SayIt</th>
                                                <th class="header translate" data-name="telegram">telegram</th>
                                                <th class="header translate" data-name="whatsapp">whatsapp</th>
                                                <th class="header translate" data-name="pushover">pushover</th>
                                                <th class="header translate" data-name="email">email</th>
                                                <th class="header translate" data-name="autoOff" style="width: 110px" data-lang="switch off"></th>
                                                <th class="header translate" data-name="timer" style="width: 110px" data-lang="switch off after minutes"></th>
                                                <th class="header translate" data-name="abort" style="width: 100px" data-lang="abort detection"></th>
                                                <th class="header translate" data-name="id"style="width: 0px; display: none;">id</th>
                                            </tr>
                                        </thead>
                                        <tbody id="dynamic-table-body" class="table-values">
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <!-- collapsible table -->

                        <ul class="collapsible expandable">

                            <!-- user devices -->
                            <li>
                                <!-- create device -->
                                <div id="header-device" onclick="selectedHeader('devices')">
                                    <!-- text -->
                                </div>
                                <div id="deviceID" class="collapsible-body blue lighten-5">
                                    <!-- <div id="deviceID" class="collapsible-body blue lighten-5" onChange="$('#btn-check-devices').removeClass('disabled')" > -->
                                    <div class="row">
                                        <div style="display: flex; align-items: center;">
                                            <div class="col left s2">
                                                <a id='btn-add-devices'
                                                    class="btn-floating waves-effect waves-light blue table-button-add translate">
                                                    <i class="material-icons">add_circle_outline</i></a>
                                                    <span class="translate" style="font-weight:bold;" data-lang="add device">add device</span>
                                            </div>
                                            <div class="col s2">
                                                <a id="btn-check-devices" class="waves-effect waves-light btn translate" data-lang="save"></a>
                                            </div>
                                            <div class="col s8 translate" id="err-devices">
                                                <!-- 'text' -->
                                            </div>
                                            <!-- Modal Trigger -->
                                            <a class="waves-effect waves-light btn modal-trigger translate"
                                                href="#modal1">help</a>
                                            <!-- Modal Structure -->
                                            <div id="modal1" class="modal">
                                                <div id="help-device" class="modal-content translate">
                                                    <div>
                                                        <!-- text -->
                                                    </div>
                                                    <div class="modal-footer">
                                                        <a href="#!"
                                                            class="modal-close waves-effect waves-green btn-flat">close</a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <span class="translate" style="font-weight:bold;" data-lang="Required fields"></span>
                                        <table class="table-values changeOnChangeEvent remove-last-column" id="create_Devices">
                                            <thead>
                                                <tr>
                                                    <th data-name="_index" style="width: 40px" class="header translate"></th>
                                                    <th data-name="name" style="width: 150px" data-type="text" class="header translate" data-lang="device name"></th>
                                                    <th id="deviceTypeID" data-name="type" style="width: 200px;" data-type="select" style="width: 150px"class="header translate" data-options="" data-lang="device type"></th>
                                                    <th data-name="consumption" style="width: 100px" data-type="OID" class="header translate" data-lang="consumption"></th>
                                                    <th data-name="switch" style="width: 100px" data-type="OID" class="header translate" data-lang="Power switch"></th>
                                                    <th data-name="startText" data-type="OID" class="header translate" data-lang="starttext"></th>
                                                    <th data-name="endText" data-type="OID" class="header translate" data-lang="endtext"></th>
                                                    <th data-name="consumptionTotal" style="width: 100px" data-type="OID" class="header translate" data-lang="total consumption" id="showConsTotal"></th>
                                                    <th data-name="unit" style="width: 100px" data-type="select" data-options="kWh;wh" data-default="kWh" class="header translate" id="showUnit" data-lang="unit"></th>
                                                    <th data-buttons="delete" style="width: 80px;" class="header translate del-Btn" data-lang="delete"></th>
                                                    <th data-name="id" style="width: 0px; display: none;" class="header translate">id</th>
                                                </tr>
                                            </thead>
                                        </table>
                                    </div>
                                </div> 
                            </li>

                            <!-- alexa devices -->
                            <li>
                                <div id="header-alexa" class="translate" onclick="selectedHeader('alexa')">
                                    <!-- text -->
                                </div>
                                <div class="collapsible-body blue lighten-5" id="alexaID">
                                    <div class="row">
                                        <div style="display: flex; align-items: center;">
                                            <div class="col left s2">
                                                <a id='btn-add-alexa'
                                                    class="btn-floating waves-effect waves-light blue table-button-add">
                                                    <i class="material-icons">add_circle_outline</i></a>
                                                <span class="translate" style="font-weight:bold;" data-lang="add device">add device</span>
                                            </div>
                                            <div class="col s2">
                                                <a id="btn-check-alexa" class="waves-effect waves-light btn translate" data-lang="save"></a>
                                            </div>
                                            <div class="col s8" id="err-alexa">
                                                <!-- 'text' -->
                                            </div>
                                            <!-- Modal Trigger -->
                                            <a class="waves-effect waves-light btn modal-trigger translate"
                                                href="#modal2">help</a>
                                            <!-- Modal Structure -->
                                            <div id="modal2" class="modal">
                                                <div id="help-alexa" class="modal-content translate">
                                                    <div>
                                                        <!-- text -->
                                                    </div>
                                                    <div class="modal-footer">
                                                        <a href="#!"
                                                            class="modal-close waves-effect waves-green btn-flat">close</a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <span class="translate" style="font-weight:bold;" data-lang="Required fields"></span>
                                    <table class="table-values changeOnChangeEvent remove-last-column">
                                        <thead>
                                            <tr>
                                                <th data-name="_index" style="width: 40px;" class="header translate"></th>
                                                <th data-name="name" data-type="text" class="header translate" data-lang="name"></th>
                                                <th data-name="path" data-type="OID" class="header translate" data-lang="'alexa2/../announcement'/'speak'"></th>
                                                <th data-name="volume" style="width: 80px" data-type="number" class="header translate" data-lang="*volume 0-100" data-default="50"></th>
                                                <th data-name="timeMinHour" style="width: 80px" data-type="select" class="header translate" data-lang="active from hour" data-default="0"data-options="0;1;2;3;4;5;6;7;8;9;10;11;12;13;14;15;16;17;18;19;20;21;22;23"></th>
                                                <th data-name="timeMinMin" style="width: 80px" data-type="select" class="header translate" data-lang="active from minute" data-default="00"data-options="00;15;30;45"></th>
                                                <th data-name="timeMaxHour" style="width: 80px" data-type="select" class="header translate" data-lang="inactive from hour" data-default="23"data-options="0;1;2;3;4;5;6;7;8;9;10;11;12;13;14;15;16;17;18;19;20;21;22;23"></th>
                                                <th data-name="timeMaxMin" style="width: 80px" data-type="select" class="header translate" data-lang="inactive from minute" data-default="59"data-options="00;15;30;45;59"></th>
                                                <th data-buttons="delete" style="width: 80px" class="header translate del-Btn" data-lang="delete"></th>
                                                <th data-name="id" style="width: 0px; display: none;" class="header translate">id</th>
                                            </tr>
                                        </thead>
                                    </table>
                                </div>
                            </li>

                            <!-- sayit -->

                            <li>
                                <div id="header-sayit" class="translate" onclick="selectedHeader('sayit')">
                                    <!-- text -->
                                </div>
                                <div class="collapsible-body blue lighten-5" id="sayitID">
                                    <div class="row">
                                        <div style="display: flex; align-items: center;">
                                            <div class="col left s2">
                                                <a id='btn-add-sayit'
                                                    class="btn-floating waves-effect waves-light blue table-button-add">
                                                    <i class="material-icons">add_circle_outline</i></a>
                                                <span class="translate" style="font-weight:bold;" data-lang="add device">add device</span>
                                            </div>
                                            <div class="col s2">
                                                <a id="btn-check-sayit" class="waves-effect waves-light btn translate" data-lang="save"></a>
                                            </div>
                                            <div class="col s8" id="err-sayit">
                                                <!-- 'text' -->
                                            </div>
                                            <!-- Modal Trigger -->
                                            <a class="waves-effect waves-light btn modal-trigger translate"
                                                href="#modal3">help</a>
                                            <!-- Modal Structure -->
                                            <div id="modal3" class="modal">
                                                <div id="help-sayit" class="modal-content translate">
                                                    <div>
                                                        <!-- text -->
                                                    </div>
                                                    <div class="modal-footer">
                                                        <a href="#!"
                                                            class="modal-close waves-effect waves-green btn-flat">close</a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <span class="translate" style="font-weight:bold;" data-lang="Required fields"></span>
                                    <table class="table-values changeOnChangeEvent remove-last-column">
                                        <thead>
                                            <tr>
                                                <th data-name="_index" style="width: 40px" class="header translate"></th>
                                                <th data-name="name" data-type="text" class="header translate" data-lang="*name"></th>
                                                <th data-name="path" data-type="OID" class="header translate" data-lang="*'sayit/../text'"></th>
                                                <th data-name="volume" style="width: 80px" data-type="number" class="header translate" data-lang="*volume 0-100" data-default="50"></th>
                                                <th data-name="timeMinHour" style="width: 80px" data-type="select" class="header translate" data-lang="active from hour" data-default="0"data-options="0;1;2;3;4;5;6;7;8;9;10;11;12;13;14;15;16;17;18;19;20;21;22;23"></th>
                                                <th data-name="timeMinMin" style="width: 80px" data-type="select" class="header translate" data-lang="active from minute" data-default="00"data-options="00;15;30;45"></th>
                                                <th data-name="timeMaxHour" style="width: 80px" data-type="select" class="header translate" data-lang="inactive from hour" data-default="23"data-options="0;1;2;3;4;5;6;7;8;9;10;11;12;13;14;15;16;17;18;19;20;21;22;23"></th>
                                                <th data-name="timeMaxMin" style="width: 80px" data-type="select" class="header translate" data-lang="inactive from minute" data-default="59"data-options="00;15;30;45;59"></th>
                                                <th data-buttons="delete" style="width: 80px" class="header translate del-Btn" data-lang="delete"></th>
                                                <th data-name="id" style="width: 0px; display: none;" class="header translate">id</th>
                                            </tr>
                                        </thead>
                                    </table>
                                </div>
                            </li>

                            <!-- pushover -->

                            <li>
                                <div id="header-pushover" class="translate" onclick="selectedHeader('pushover')">
                                    <!-- text -->
                                </div>
                                <div class="collapsible-body blue lighten-5" id="pushoverID">
                                    <div class="row">
                                        <div style="display: flex; align-items: center;">
                                            <div class="col left s2">
                                                <a id='btn-add-pushover'
                                                    class="btn-floating waves-effect waves-light blue table-button-add">
                                                    <i class="material-icons">add_circle_outline</i></a>
                                                <span class="translate" style="font-weight:bold;" data-lang="add device">add device</span>
                                            </div>
                                            <div class="col s2">
                                                <a id="btn-check-pushover" class="waves-effect waves-light btn translate" data-lang="save"></a>
                                            </div>
                                            <div class="col s8" id="err-pushover">
                                                <!-- 'text' -->
                                            </div>
                                            <!-- Modal Trigger -->
                                            <a class="waves-effect waves-light btn modal-trigger translate"
                                                href="#modal5">help</a>
                                            <!-- Modal Structure -->
                                            <div id="modal5" class="modal">
                                                <div id="help-pushover" class="modal-content translate">
                                                    <div>
                                                        <!-- text -->
                                                    </div>
                                                    <div class="modal-footer">
                                                        <a href="#!"
                                                            class="modal-close waves-effect waves-green btn-flat">close</a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <span class="translate" style="font-weight:bold;" data-lang="Required fields"></span>
                                    <table class="table-values changeOnChangeEvent remove-last-column">
                                        <thead>
                                            <tr>
                                                <th data-name="_index" style="width: 40px" class="header translate"></th>
                                                <th data-name="name" data-type="text" class="header translate" data-lang="*name"></th>
                                                <th data-name="inst" data-type="select" class="header translate" data-lang="*pushover instance" data-default=".0" data-options=".0;.1;.2;.3;.4;.5"></th>
                                                <th data-name="prio" data-type="select" class="header translate" data-lang="*priority" data-default="normal" data-options="normal;high;quiet"></th>
                                                <th data-name="sound" data-type="select" class="header translate" data-lang="*sound" data-default="pushover"data-options="pushover; bike; bugle; cashregister; classical; cosmic; falling; gamelan; incoming; intermission; magic; mechanical; pianobar; siren; spacealarm; tugboat; alien; climb; persistent; echo; updown; none"></th>
                                                <th data-buttons="delete" style="width: 80px" class="header translate del-Btn" data-lang="delete"></th>
                                                <th data-name="id" style="width: 0px; display: none;" class="header translate">id </th>
                                            </tr>
                                        </thead>
                                    </table>
                                </div>
                            </li>

                            <!-- email -->

                            <li>
                                <div id="header-email" class="translate" onclick="selectedHeader('email')">

                                </div>
                                <div class="collapsible-body blue lighten-5" id="emailID">
                                    <div class="row">
                                        <div style="display: flex; align-items: center;">
                                            <div class="col left s2">
                                                <a id='btn-add-email'
                                                    class="btn-floating waves-effect waves-light blue table-button-add">
                                                    <i class="material-icons">add_circle_outline</i></a>
                                                <span class="translate" style="font-weight:bold;" data-lang="add device">add device</span>
                                            </div>
                                            <div class="col s2">
                                                <a id="btn-check-email" class="waves-effect waves-light btn translate" data-lang="save"></a>
                                            </div>
                                            <div class="col s8" id="err-email">
                                                <!-- text -->
                                            </div>
                                            <!-- Modal Trigger -->
                                            <a class="waves-effect waves-light btn modal-trigger translate"
                                                href="#modal6">help</a>
                                            <!-- Modal Structure -->
                                            <div id="modal6" class="modal">
                                                <div id="help-email" class="modal-content translate">
                                                    <div>
                                                        <!-- text -->
                                                    </div>
                                                    <div class="modal-footer">
                                                        <a href="#!"
                                                            class="modal-close waves-effect waves-green btn-flat">close</a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <span class="translate" style="font-weight:bold;" data-lang="Required fields"></span>
                                    <table class="table-values changeOnChangeEvent remove-last-column">
                                        <thead>
                                            <tr>
                                                <th data-name="_index" style="width: 40px" class="header translate"></th>
                                                <th data-name="name" data-type="text" class="header translate" data-lang="*name"></th>
                                                <th data-name="emailFrom" data-type="text" class="header translate" data-lang="*sender address"></th>
                                                <th data-name="emailTo" data-type="text" class="header translate" data-lang="*receiver address"></th>
                                                <th data-buttons="delete" style="width: 80px" class="header translate del-Btn" data-lang="delete"></th>
                                                <th data-name="id" style="width: 0px; display: none;" class="header translate">id</th>
                                            </tr>
                                        </thead>
                                    </table>
                                </div>
                            </li>

                            <!-- default devices -->

                            <!-- <li>
                                <div id="header-default" class="translate" onclick="selectedHeader('default')"> -->
                                    <!-- text -->
                                <!-- </div>
                                <div class="collapsible-body blue lighten-5" id="defaultTypeID">
                                    <div class="row">
                                        <div style="display: flex; align-items: center;">
                                            <div>
                                                <a id="btn-check-default" class="waves-effect waves-light btn translate" data-lang="save"></a>
                                            </div>
                                            <div class="col s10" id="err-default"> -->
                                                <!-- 'text' -->
                                            <!-- </div> -->
                                            <!-- Modal Trigger -->
                                            <!-- <a class="waves-effect waves-light btn modal-trigger translate"
                                                href="#modal7">help</a> -->
                                            <!-- Modal Structure -->
                                            <!-- <div id="modal7" class="modal">
                                                <div id="help-default-type" class="modal-content translate">
                                                    <div> -->
                                                        <!-- text -->
                                                    <!-- </div>
                                                    <div class="modal-footer">
                                                        <a href="#!"
                                                            class="modal-close waves-effect waves-green btn-flat">close</a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div>
                                        <h3><span class="translate" data-lang="default device types"></span></h3>
                                    </div>
                                    <table id="disableFirstField" class="table-values remove-last-column">
                                        <thead>
                                            <tr>
                                                <th id="disableFirstField" class="header translate" data-type="text" data-name="name" data-lang="name"></th>
                                                <th class="header translate" data-type="number" data-name="startVal" data-lang="threshold 'start' (watt)"></th>
                                                <th class="header translate" data-type="number" data-name="endVal" data-lang="threshold 'end' (watt)"></th>
                                                <th class="header translate" data-type="number" data-name="standby" data-lang="threshold 'standby' (watt)"></th>
                                                <th class="header translate" data-type="number" data-name="startCount" data-lang="number of 'start' values"></th>
                                                <th class="header translate" data-type="number" data-name="endCount" data-lang="number of ​'end' values"></th>
                                                <th class="header translate" data-type="number" data-name="id" style="width: 0px; display: none;">id</th>
                                            </tr>
                                        </thead>
                                    </table>
                                </div>
                            </li> -->

                            <!-- custom devices -->

                            <li>
                                <div id="header-types" class="translate" onclick="selectedHeader('types')">
                                    <!-- text -->
                                </div>
                                <div class="collapsible-body blue lighten-5" id="typesID">
                                    <div class="row">
                                        <div style="display: flex; align-items: center;">
                                            <div class="col left s2">
                                                <a id='btn-add-types'
                                                    class="btn-floating waves-effect waves-light blue table-button-add">
                                                    <i class="material-icons">add_circle_outline</i></a>
                                                <span class="translate" style="font-weight:bold;" data-lang="add device">add device</span>
                                            </div>
                                            <div class="col s2">
                                                <a id="btn-check-types" class="waves-effect waves-light btn translate" data-lang="save"></a>
                                            </div>
                                            <div class="col s8" id="err-types">
                                                <!-- 'text' -->
                                            </div>
                                            <!-- Modal Trigger -->
                                            <a class="waves-effect waves-light btn modal-trigger translate"
                                                href="#modal8">help</a>
                                            <!-- Modal Structure -->
                                            <div id="modal8" class="modal">
                                                <div id="help-types-type" class="modal-content translate">
                                                    <div>
                                                        <!-- text -->
                                                    </div>
                                                    <div class="modal-footer">
                                                        <a href="#!"
                                                            class="modal-close waves-effect waves-green btn-flat translate">close</a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div>
                                        <h3><span class="translate" data-lang="types device types"></span></h3>
                                    </div>
                                    <table id="create_types" class="table-values remove-last-column">
                                        <thead>
                                            <tr>
                                                <th class="header translate" data-type="text" data-name="name" data-lang="name"></th>
                                                <th class="header translate" data-type="number" data-name="startVal" data-lang="threshold 'start' (watt)"></th>
                                                <th class="header translate" data-type="number" data-name="endVal" data-lang="threshold 'end' (watt)"></th>
                                                <th class="header translate" data-type="number" data-name="standby" data-lang="threshold 'standby' (watt)"></th>
                                                <th class="header translate" data-type="number" data-name="startCount" data-lang="number of 'start' values"></th>
                                                <th class="header translate" data-type="number" data-name="endCount" data-lang="number of ​'end' values"></th>
                                                <th data-buttons="delete" style="width: 80px" class="header translate del-Btn" data-lang="delete"></th>
                                                <th class="header translate" data-type="number" data-name="id" style="width: 0px; display: none;">id</th>
                                            </tr>
                                        </thead>
                                    </table>
                                </div>
                            </li>

                            <!-- status -->

                            <li>
                                <div id="header-status" class="translate" onclick="selectedHeader('status')">
                                    <!-- text -->
                                </div>
                                <div class="collapsible-body blue lighten-5" id="valStates">
                                    <div class="row">
                                        <div style="display: flex; align-items: center;">
                                            <div class="col s8" id="err-status">
                                                <!-- 'text' -->
                                            </div>
                                        </div>
                                    </div>
                                    <div>
                                        <h5><span class="translate" data-lang="device status"></span></h5>
                                    </div>
                                    <table class="table-values changeOnChangeEvent remove-first-column" id="table-states">
                                        <thead>
                                            <tr>
                                                <th class="header translate" style="width: 0px; display: none;"></th>
                                                <th class="header translate" data-type="text" data-name="stateAction" data-lang="status: 'in action'"></th>
                                                <th class="header translate" data-type="text" data-name="stateStandby" data-lang="status: 'standby'"></th>
                                                <th class="header translate" data-type="text" data-name="stateOff" data-lang="status: 'device off'"></th>
                                                </tr>
                                        </thead>
                                    </table>
                                </div>
                            </li>

                            <!-- costs -->

                            <li>
                                <div id="header-costs" class="translate" onclick="selectedHeader('costs')">
                                    <!-- text -->
                                </div>
                                <div class="collapsible-body blue lighten-5" id="valCosts">
                                    <div class="row">
                                        <div style="display: flex; align-items: center;">
                                            <div class="col s8" id="err-costs">
                                                <!-- 'text' -->
                                            </div>
                                        </div>
                                    </div>
                                    <div>
                                        <h5><span class="translate" data-lang="Costs for the device operation"></span></h5>
                                    </div>
                                    <table class="table-values changeOnChangeEvent remove-first-column" id="table-costs">
                                        <thead>
                                            <tr>
                                                <th class="header translate" style="width: 0px; display: none;"></th>
                                                <th class="header translate" data-type="checkbox" data-options="true;false" data-name="active" style="width: 60px" data-lang="active" id="checkCosts"></th>
                                                <th class="header translate" data-type="number" data-name="costs" style="width: 150px" data-lang="costs"></th>
                                                <th class="header translate" data-type="text" data-name="currency" style="width: 150px" data-lang="currency"></th>
                                            </tr>
                                        </thead>
                                    </table>
                                </div>
                            </li>

                            <!-- collapsible end -->

                        </ul>






                    </div>
                </div>

                <!-- Tab with id "advanced-settings" -->
                <!-- <div id="tab-advanced-settings" class="col s12">
                    <div class="row">
                        <div class="row">
                            <div class="input-field col s3">
                                <img src="icon.png">
                            </div>
                        </div> -->

                        <!-- <div id="presence" class="card-panel blue lighten-5">
                            <b>Presence detection</b>
                        </div> -->

                        <!-- <div id="loop" class="card-panel blue lighten-5">
                            <b>Loop announcements</b> 
                        </div> -->

                        <!--presence detection -->
                        <!-- <div class="card-panel blue lighten-5" id="presence">
                            <div>
                                <h5>Presence-dependent notifications</h5>
                            </div>
                            <table class="table-values changeOnChangeEvent">
                                <thead>
                                    <tr>
                                        <th class="header translate" data-type="checkbox" data-name="presence_Notification" style="width:150">Notification when present again?</th>
                                        <th class="header translate" data-type="checkbox" data-name="presence_msg" style="width:150px">Send notifications to text messenger anyway?</th>
                                        <th class="header translate" data-type="OID" data-name="dp_presence" style="text-align: left">Path "presence"</th>
                                    </tr>
                                </thead>
                            </table>
                        </div> -->


                    <!-- </div>
                </div> -->
            </div>
        </div>
    </div>

    <div class="m material-dialogs">
        <div id="dialog-select-member" class="modal modal-fixed-footer">
            <div class="modal-content">
                <div class="row">
                    <div class="col s12 title"></div>
                </div>
                <div class="row">
                    <div class="col s12 dialog-content"></div>
                </div>
            </div>
            <div class="modal-footer">
                <a class="modal-action modal-close waves-effect waves-green btn btn-set"><i
                        class="large material-icons left">check</i><span class="translate">Select</span></a>
                <a class="modal-action modal-close waves-effect waves-green btn btn-close"><i
                        class="large material-icons left ">close</i><span class="translate">Cancel</span></a>
            </div>
        </div>
    </div>
</body>

</html>